<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libretto - Room List</title>
    <style>
        /*<![CDATA[*/
            {{ String::from_utf8_lossy(crate::Dist::get("room_list.css").unwrap().data) | safe}}
        /*]]>*/
    </style>
    {{ crate::DistVite::get_html_tags_for_asset::<crate::Dist>("js/room_list.js") | safe }}
</head>
<body>
    <div class="room-list-container">
        <div class="room-list-header">
            <h1>Libretto</h1>
            <p>Your Matrix rooms</p>
        </div>
        
        <div class="room-list-filters">
            <button id="direct-rooms" class="filter-button">Direct Messages</button>
            <button id="encrypted-rooms" class="filter-button">Encrypted Rooms</button>
            <button id="unread-rooms" class="filter-button">Unread Rooms</button>
        </div>
        
        <div class="room-grid">
            {% for room in rooms %}
            <a href="/room/{{ room.id | urlencode }}" class="room-card" 
               data-is-direct="{{ room.is_direct }}" 
               data-is-encrypted="{{ room.is_encrypted }}"
               data-has-unread="{{ room.has_unread() }}">
                <div class="room-indicators">
                    {% if room.is_encrypted %}
                    <div class="room-indicator encrypted-indicator" title="Encrypted Room">
                        ðŸ”’
                    </div>
                    {% endif %}
                    {% if room.is_direct %}
                    <div class="room-indicator direct-indicator" title="Direct Message">
                        ðŸ‘¤
                    </div>
                    {% endif %}
                </div>
                
                <div class="room-card-header">
                    <div class="room-avatar">

                        {% if let Some(avatar_url) = room.avatar_url %}
                        <img src="{{ avatar_url.to_string() }}" alt="{{ room.name.to_string() }}">
                        {% else %}
                        {{ room.name_initial() }}
                        {% endif %}
                    </div>
                    <h3 class="room-name">{{ room.name.to_string() }}</h3>
                </div>
                {% if room.has_unread() %}
                <div class="room-unread-count">
                    {{ room.unread_count }}
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
    </div>
</body>
</html>
